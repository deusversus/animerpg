# AIDM v2.0 - Quick Continuation Guide

## ðŸ”§ SYSTEM INTEGRATION & SCAFFOLDING ARCHITECTURE

**Last Updated**: 2025-01-XX  
**Version**: v2.0 (Core + Narrative Calibration + **Scaffolding + Genre Integration COMPLETE**)  
**Status**: Core optimized âœ… | 13 profiles created âœ… | **INTEGRATION AUDIT COMPLETE** âœ… | **PRIORITY 1+2+3 COMPLETE** âœ…

## System Status

**Core Files**: 15 instruction modules + 8 schemas + 12 libraries (100% complete) âœ…  
**Narrative Profiles**: 13/100+ with scaffolding sections + genre cross-references âœ…  
**Genre Libraries**: **12/12 COMPLETE** (~55,000+ words) âœ…  
**Integration Status**: **Scaffolding + Genre System COMPLETE** (Module 13 rules + 12 profile examples + 12 genre libraries + bidirectional cross-references) âœ…  
**Token Budget**: ~20,567 tokens base (10.3% of 200K context) - Highly efficient âœ…  

**Primary Guides**: `MODULE_INTEGRATION_AUDIT.md` + `PRIORITY_3_COMPLETION_SUMMARY.md` + `PRIORITY_3_EXTENDED_COMPLETION_SUMMARY.md`

---

## CRITICAL ARCHITECTURAL UNDERSTANDING

**AIDM is an intelligent scaffolding system, NOT a prescriptive database**:

### What AIDM Actually Is

âœ… **Narrative Profile Generator**: Automatically extracts DNA from ANY anime (Module 07 + Module 13)  
âœ… **Mechanical Scaffolding System**: Maps narrative DNA â†’ game systems using library **templates**  
âœ… **Modular Pre-Made Profiles**: Optional convenience shortcuts (DanDaDan, HxH = **examples with scaffolding**, not requirements)

### Libraries = Templates, Not Rules

- `power_systems/` = Pattern templates AIDM references when mapping powers â†’ mechanics
- `genre_tropes/` = Pattern libraries for generation (âš ï¸ **INCOMPLETE**: Missing seinen/shoujo/mecha/sports/thriller/slice-of-life)
- `stat_frameworks/` = Mapping guidance ("Tactical 7-10 â†’ 6-stat framework")

### Pre-Made Profiles = Reference Implementations

- **NOW INCLUDE**: "Mechanical Scaffolding (Reference Implementation)" sections (~1,000-2,500 words each) âœ…
- Show example mapping decisions ("DanDaDan Fast-Paced 2/10 â†’ High XP 1K-1.5K/session, Accelerated growth")
- AIDM uses as templates when generating new profiles for similar anime

---

## Recent Updates

**Latest (2025-01-07)**: Priority 1 + Priority 2 + Priority 3 Extended Complete âœ…
- âœ… **Priority 1** (8-10 hours): Module 13 scaffolding rules + ALL 12 profiles + Module 03 state tracking (~20,000 words)
- âœ… **Priority 2** (3-4 hours): Module 02 NARRATIVE_STYLE + Module 01 flow docs + initial genre cross-references (~3,200 words)
- âœ… **Priority 3 Initial** (8-10 hours): First 7 genre libraries (sports, shoujo_romance, mecha) + 9 profile cross-references (~13,500 words)
- âœ… **Priority 3 Extended** (10-12 hours): 5 NEW genre libraries (horror, mystery/thriller, comedy, supernatural, sci-fi) + comprehensive integration (~26,000 words)
- ðŸ“Š **Total Implementation**: ~62,700 words added across 9 modules, 12 genre libraries, 15 narrative profiles
- ðŸŽ¯ **Coverage**: 95%+ of top anime (12 comprehensive genre libraries)
- ðŸŽ¯ **Next**: Optional niche libraries (magical girl ~2%, music ~2%, historical ~1%) OR test profile generation OR move to next development phase

**Previous (October 11, 2025)**: Integration Audit Complete + Scaffolding Architecture Defined
- âœ… Audited ALL 13 instruction modules for Module 13 integration
- âœ… **7 Integration Issues Found** (Module 12/13 redundancy, Module 09 pacing ignored, missing scaffolding rules, etc.)
- âœ… Created `MODULE_INTEGRATION_AUDIT.md` (~15K words) with scaffolding approach
- âœ… Created `SCAFFOLDING_IMPLEMENTATION_PLAN.md` (~8K words) detailed guide
- âœ… **Architectural Clarification**: AIDM generates profiles intelligently, pre-made = examples

---

## Current Priorities

### âœ… Priority 1-3 Extended COMPLETE âœ… (Total: ~40-50 hours)

**All Completed**: Narrative calibration system, scaffolding integration, genre libraries complete

---

### ðŸ”„ NEW Priority: Phase 2.1 - Core Systems Restoration (October 2025)

**Context**: v2 focused on narrative authenticity. v1 had gameplay depth systems that were intentionally deferred. Now restoring critical gameplay mechanics.

**High Priority Systems** (Q4 2025 - Essential):

1. **Quest Management System** (~8-12 hours)
   - Create quest_schema.json (quest state, objectives, branches, rewards)
   - Expand Module 03 (State Manager) with quest tracking
   - Integrate Module 05 (Narrative Systems) for quest generation
   - Module 02 (Learning Engine) quest memory integration
   - **Current Gap**: Quests tracked informally in memory threads only

2. **Faction/Reputation System** (~6-10 hours)
   - Create faction_schema.json (faction reputation, politics, relationships)
   - Expand Module 04 (NPC Intelligence) with faction affinity mechanics
   - Module 05 narrative drift integration (faction wars, alliances)
   - **Current Gap**: Only individual NPC affinity exists (-100 to +100)

3. **Economy System** (~6-8 hours)
   - Create economy_schema.json (currency, market prices, inflation)
   - Expand Module 03 state tracking for monetary transactions
   - Merchant NPC integration with Module 04
   - **Current Gap**: Inventory exists but no monetary mechanics

4. **Timekeeping/Calendar System** (~4-6 hours)
   - Expand world_state_schema.json (calendar, seasons, holidays, aging)
   - Module 05 time-sensitive events integration
   - Long-term campaign time tracking
   - **Current Gap**: Only time of day exists

5. **Romance Mechanics** (~4-6 hours)
   - Expand Module 04 (NPC Intelligence) with romance substates
   - Confession mechanics, dating systems, love triangles, jealousy
   - Romance flags in NPC relationships (anime-authentic)
   - **Current Gap**: Generic affinity system lacks romance specifics

**Medium Priority** (Q1 2026 - Deferred to Phase 2.5):
- Training systems, tournament arcs, death mechanics, mass combat, downtime activities
- Crafting, guilds, base building (port from v1 as TIER 3 libraries)

**Implementation Strategy**:
1. Create missing schemas first (quest, faction, economy)
2. Expand existing modules (Module 03, 04, 05)
3. Port v1 systems to v2 architecture as lazy-load libraries (optional depth)

**See**: `docs/ROADMAP.md` for complete Phase 2.1 breakdown

---

### Previous Priorities (COMPLETE âœ…)

**Priority 1-3 Extended** (Narrative System):
- âœ… Module 13 scaffolding rules
- âœ… 12 CORE profiles with mechanical scaffolding
- âœ… Module 03 state tracking (generated profiles)
- âœ… Module 02 NARRATIVE_STYLE memory
- âœ… 12 comprehensive genre libraries (~55,000 words)
- âœ… 95%+ top anime coverage

**Profile Expansion**: **PAUSED** (13/100 complete - sufficient for v2.0)

---

## Integration Issues Found (7 Critical Findings)

**Full audit**: See `MODULE_INTEGRATION_AUDIT.md`

1. **ðŸ”´ Module 12/13 No Mapping Rules** - Power Fantasy scale doesn't map to Growth model
2. **ðŸ”´ Module 09 Pacing No Mapping** - Fast/Slow scale doesn't map to XP multiplier
3. **ðŸŸ¡ Module 01 Flow Undocumented** - Genre libraries integration unclear
4. **ðŸŸ¡ Module 02 No Narrative Memory** - No category for profile adjustments
5. **ðŸ”´ Missing Scaffolding Examples** - Pre-made profiles don't show mapping decisions
6. **ðŸŸ¡ Module 13 Incomplete Docs** - Missing scaffolding section
7. **ðŸŸ¡ Module 03 No State Tracking** - Generated profiles can't persist (CRITICAL)

**Integration Score**: 4/13 modules actively use Module 13  
**Solution**: Add scaffolding rules + examples (24-34 hours total)

---

## Key Architecture Reminders

**Session Zero Flow (ACTUAL)**:

```
Player: "I want Chainsaw Man vibes!"

AIDM:
1. Check: Does chainsaw_man_profile.md exist? 
   â†’ NO (not in 13 CORE profiles)
   
2. GENERATE PROFILE (Module 07 + Module 13):
   - Research Chainsaw Man
   - Extract narrative DNA (10 scales, 15 tropes)
   
3. MAP TO MECHANICS (Scaffolding Rules):
   - Fast-Paced 3/10 â†’ High XP model
   - Power Fantasy 5/10 â†’ Accelerated growth
   - Tactical 4/10 â†’ 6-stat framework
   
   â†’ SELECT: soul_spirit_systems.md, 6-stat, Accelerated XP
   
4. PLAY: Use generated profile + systems
```

**Pre-made profiles = shortcuts skipping steps 2-3**

---

## Where to Continue Development

**Primary Focus**: System Integration - Scaffolding Rules

### Priority 1 Implementation (6-8 hours)

1. **Add scaffolding section to Module 13**
   - "Narrative DNA â†’ Mechanical Scaffolding" (~1,500-2,000 words)
   - Power Level, Progression, Combat, Power System mapping rules
   
2. **Add scaffolding examples to 12 profiles**
   - "Mechanical Scaffolding (Reference Implementation)" (~500-700 words each)
   
3. **Add state tracking to Module 03**
   - Track generated profiles (critical for persistence)

### After Priority 1: Genre Libraries (8-12 hours)

**Missing**: seinen, shoujo, mecha, sports, thriller, slice_of_life tropes



## System Architecture

### Core Instruction Modules (15 files)
- `00_system_initialization.md` - Bootstrap & lazy-loading (TIER 1/2/3 strategy)
- `01_cognitive_engine.md` - Intent classification
- `02_learning_engine.md` - Memory creation/retrieval
- `03_state_manager.md` - State validation/persistence
- `04_npc_intelligence.md` - NPC behavior
- `05_narrative_systems.md` - Story hooks/pacing
- `06_session_zero.md` - Character creation
- `07_anime_integration.md` - Research & harmonization
- `08_combat_resolution.md` - Battle mechanics
- `09_progression_systems.md` - XP & leveling
- `10_error_recovery.md` - Error handling
- `11_dice_resolution.md` - RNG transparency
- `12_player_agency.md` - Sacred choice rule
- `13_narrative_calibration.md` - **Narrative DNA system** âœ… (optimized)
- `CORE_AIDM_INSTRUCTIONS.md` - Master control

### Narrative Profile Library (13 â†’ 100+ profiles)
**Current (13 profiles)**:
- DanDaDan, Hunter x Hunter, Jujutsu Kaisen, Demon Slayer, Attack on Titan
- Konosuba, Death Note, Re:Zero, Mushishi, Vinland Saga
- Code Geass, Haikyuu, (original profile)

**Master Index**: `PROFILE_INDEX.md` âœ… (optimized, 1,186 words)
- Genre organization (Battle Shonen, Dark Fantasy, Comedy, etc.)
- Cross-reference matrix (15 player request mappings)
- Blending guidelines (hybrid campaign strategies)
- 4 quick-start workflows

**Profile Structure** (standardized):
- 10 narrative scales (0-10 values)
- 15 trope switches (ON/OFF)
- Pacing rhythm, tonal signature, dialogue/combat styles
- 3 example scenes (combat, dialogue, exploration)
- Usage notes & calibration tips

**Lazy Loading** âœ…:
- Module 13: TIER 2 (loaded with Module 07)
- PROFILE_INDEX: TIER 3 (Session Zero only)
- Individual profiles: TIER 3 (only when selected)
- **Token cost**: 0 if unused, ~3,500-5,300 for typical usage (1-2 profiles)

### Reference Libraries (12 files)
**Power Systems** (5 files):
- `mana_magic_systems.md` - External energy (Fairy Tail, Black Clover, etc.)
- `ki_lifeforce_systems.md` - Internal energy (Dragon Ball, Naruto, HxH, etc.)
- `soul_spirit_systems.md` - Metaphysical (Jujutsu Kaisen, Bleach, etc.)
- `psionic_psychic_systems.md` - Mental powers (Mob Psycho, Saiki K, etc.)
- `power_tier_reference.md` - VS Battles tier mapping

**Genre Tropes** (4 files):
- `isekai_tropes.md` - 5 isekai variants, cheat skills, guild systems
- `shonen_tropes.md` - Training arcs, tournaments, transformations
- `seinen_tropes.md` - Psychological thriller, death games, anti-heroes
- `slice_of_life_tropes.md` - School life, romance, iyashikei

**Common Mechanics** (3 files):
- `stat_frameworks.md` - 6-stat D&D, anime-specific systems
- `leveling_curves.md` - XP systems, progression speeds
- `skill_taxonomies.md` - Active/passive/ultimate skills

### Schemas (8 JSON files)
- `character_schema.json`, `world_state_schema.json`, `session_export_schema.json`
- `npc_schema.json`, `memory_thread_schema.json`, `power_system_schema.json`
- `anime_world_schema.json`, `narrative_profile_schema.json`

---

## Token Budget Analysis

**Current System** (~20,567 tokens, 10.3% of 200K):
- Core instructions: ~13,669 tokens (15 modules optimized)
- Narrative system: ~2,326 tokens (Module 13 + INDEX optimized)
- Libraries: ~4,500 tokens (power systems, genres, mechanics)
- Schemas: ~72 tokens (compact JSON)

**Narrative Profile Impact** (lazy-loaded):
- **Scenario 1** (no calibration): 0 tokens
- **Scenario 2** (typical, 1-2 profiles): ~3,500-5,300 tokens
- **Scenario 3** (hybrid, 3 profiles): ~5,900-7,100 tokens
- **Worst case** (all 13 profiles): ~18,741 tokens (not recommended)

**Total Budget** (typical usage): ~24,000-26,000 tokens (12-13% of 200K) âœ…

---

## Next Actions

**Immediate**:
1. **Continue Phase 1 expansion**: Create next profile (FMA:B, Naruto, or One Piece)
2. **Batch creation option**: Create 3-5 profiles in one session
3. **Track progress**: Update EXPANSION_ROADMAP.md after each profile

**Short-term** (after Phase 1 complete):
- Fill genre gaps (Phase 2: 15 more profiles â†’ 40 total)
- Optimize all profiles at once (40-50% reduction, ~8,000 tokens saved)

**Long-term**:
- Deep genre coverage (Phase 3: 70 profiles)
- Long tail + niche (Phase 4: 100+ profiles)
- Community request tracking

**Detailed roadmap**: See `aidm/libraries/narrative_profiles/EXPANSION_ROADMAP.md`

---

## ðŸ“‹ Quick Commands for Development

### Word Counting (Token Estimation)
```powershell
# Single file word count
Get-Content "aidm/instructions/13_narrative_calibration.md" | Measure-Object -Word | Select-Object -ExpandProperty Words

# Multiple files total
$files = @("hunter_x_hunter_profile.md", "attack_on_titan_profile.md"); 
$total = 0; 
foreach($f in $files) { 
    $wc = (Get-Content "aidm/libraries/narrative_profiles\$f" | Measure-Object -Word).Words; 
    $total += $wc 
}; 
Write-Output "Total: $total words (~$([math]::Round($total * 0.75)) tokens)"
```

### Git Workflow
```powershell
# Check status
git status

# Add and commit
git add aidm/libraries/narrative_profiles/*.md
git commit -m "PROFILES: Add [anime names] profiles"

# Push to GitHub
git push origin main

# View recent commits
git log --oneline -5
```

### Validation Tests
```powershell
# Check if all critical data preserved (example)
Get-Content "aidm/instructions/13_narrative_calibration.md" | Select-String -Pattern "Introspection vs Action|Comedy vs Drama" | Measure-Object | Select-Object -ExpandProperty Count

# Verify profile IDs exist in index
Get-Content "aidm/libraries/narrative_profiles/PROFILE_INDEX.md" | Select-String -Pattern "narrative_hxh|narrative_aot" | Measure-Object | Select-Object -ExpandProperty Count
```

---

## Key Design Principles

1. **Player Agency is Sacred** - Choices must matter, railroading forbidden
2. **Emergent > Predetermined** - React to players, don't force plots
3. **Consistency is Critical** - State must remain logically coherent
4. **Fail Safely** - Errors handled gracefully, never crash
5. **Research First** - Never fake anime knowledge (AUTOMATIC, BLOCKING)
6. **Yes, And...** - Default to enabling creativity, not blocking it
7. **Zero Tolerance for Data Loss** - 100% information parity during optimization
8. **Machine-Interpreter Oriented** - Optimize for LLM parsing, not human decoration

---

## Quick Reference

- **Expansion Roadmap**: `aidm/libraries/narrative_profiles/EXPANSION_ROADMAP.md` - Top 100 anime list, 4-phase strategy
- **Profile Index**: `aidm/libraries/narrative_profiles/PROFILE_INDEX.md` - Master catalog, genre organization
- **Optimization Methodology**: `docs/TOKEN_OPTIMIZATION_METHODOLOGY.md` - Multi-pass techniques, validation protocols
- **Architecture**: `docs/ARCHITECTURE.md` - Complete system design
- **State**: `docs/STATE.md` - Current status, comprehensive changelog
- **Core Control**: `aidm/CORE_AIDM_INSTRUCTIONS.md` - Master control file

---

## Where to Continue Development

**Priority 3 Extended COMPLETE âœ…**:
1. âœ… **Created first 7 genre libraries** (~26,500 words total)
   - sports_tropes.md (~5,500 words), shoujo_romance_tropes.md (~3,500 words verified), mecha_tropes.md (~4,500 words)
   - Existing: shonen_tropes.md, isekai_tropes.md, seinen_tropes.md, slice_of_life_tropes.md
2. âœ… **Created 5 NEW genre libraries** (~26,000 words total)
   - horror_tropes.md (~5,000 words), mystery_thriller_tropes.md (~5,500 words), comedy_tropes.md (~5,000 words)
   - supernatural_tropes.md (~5,000 words), scifi_tropes.md (~5,500 words)
3. âœ… **Added genre cross-references to 9 CORE profiles** - Jujutsu Kaisen, Demon Slayer, Attack on Titan, Konosuba, Re:Zero, Mushishi, Vinland Saga, Code Geass, Haikyuu
4. âœ… **Added genre cross-references to Steins;Gate** (non-CORE format) - sci-fi + mystery/thriller + seinen
5. âœ… **Bidirectional integration complete** - All 12 libraries â†” all 13 profiles cross-referenced
6. âœ… **Coverage validated** - 95%+ of top anime (12 comprehensive libraries)

**Genre Library System**: **12/12 COMPLETE** (~55,000+ words total)
- shonen_tropes.md, isekai_tropes.md, seinen_tropes.md, slice_of_life_tropes.md, sports_tropes.md, shoujo_romance_tropes.md, mecha_tropes.md, horror_tropes.md, mystery_thriller_tropes.md, comedy_tropes.md, supernatural_tropes.md, scifi_tropes.md

**See**: `PRIORITY_3_COMPLETION_SUMMARY.md` + `PRIORITY_3_EXTENDED_COMPLETION_SUMMARY.md` for full documentation

**Future Development** (Long-term):
- Test intelligent profile generation (Module 07 + Module 13 workflow)
- Generate test profiles: Chainsaw Man, Frieren, Spy x Family
- Expand to niche genre libraries: horror, mystery/thriller, historical, parody
- Power system library expansion (cursed energy, breathing styles, time loops)
- Campaign conversion examples (genre library application demos)
- Update EXPANSION_ROADMAP with scaffolding approach

**GitHub Repository**: https://github.com/deusversus/animerpg

---

**CURRENT CONTEXT: Priority 1+2+3 Extended COMPLETE âœ… (Scaffolding integration + Genre library system FULLY complete). System has: Module 13 rules + 12 CORE profiles with mechanical scaffolding + Module 03 state tracking + Module 02 NARRATIVE_STYLE memory + Module 01 cognitive flow + 12 comprehensive genre libraries (~55,000 words) + full bidirectional integration + 95%+ top anime coverage. Ready for optional niche libraries (magical girl/music/historical ~5%), intelligent profile generation testing, live gameplay validation, or next development phase.** ðŸŽ¯

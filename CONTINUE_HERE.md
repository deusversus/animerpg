# AIDM v2.0 - Quick Continuation Guide

## ðŸŽ­ NARRATIVE PROFILE LIBRARY EXPANSION

**Last Updated**: October 10, 2025  
**Version**: v2.0 (Core System + Narrative Calibration + Profile Expansion Phase)  
**Status**: Core optimized âœ… | 13 profiles created âœ… | Expanding to 100+ profiles ðŸŽ¯

## System Status

**Core Files**: 15 instruction modules + 8 schemas + 12 libraries (100% complete) âœ…  
**Narrative Profiles**: 13/100+ (Phase 1 expansion in progress)  
**Token Budget**: ~20,567 tokens (10.3% of 200K context) - Highly efficient âœ…  
**Coverage**: 85-90% anime power systems, 90%+ genre tropes, 13 anime narrative profiles  
**Optimization**: Core system optimized (39% reduction on Module 13 + INDEX)

**Primary Guide**: `aidm/libraries/narrative_profiles/EXPANSION_ROADMAP.md`

---

## Recent Updates

**Latest (October 10, 2025)**: Narrative Profile Library Expansion
- âœ… Module 13 optimized (2,925â†’1,915 words, 35% reduction, zero data loss)
- âœ… PROFILE_INDEX optimized (2,121â†’1,186 words, 44% reduction, 100% parity)
- âœ… Session 1 optimization complete (~1,459 tokens saved)
- âœ… Created EXPANSION_ROADMAP.md (Top 100 anime list, 4-phase strategy)
- âœ… 13 profiles complete: DanDaDan, HxH, JJK, Demon Slayer, AoT, Konosuba, Death Note, Re:Zero, Mushishi, Vinland Saga, Code Geass, Haikyuu, plus original
- ðŸŽ¯ Phase 1 target: Next 12 profiles to complete Top 25 all-time anime

**Validation**: All critical data preserved (10 scales, 15 tropes, 12 profile IDs, 15 cross-references verified via grep tests)

**Previous**: Token optimization methodology integrated, workspace reorganized, core system complete

---

## Current Priorities

### ðŸŽ¯ Narrative Profile Library Expansion (Active)

**Goal**: Build library from 13 â†’ 100+ profiles covering most popular/beloved anime

**Phase 1** (Next 12 profiles â†’ 25 total):
- [ ] Fullmetal Alchemist: Brotherhood
- [ ] Naruto/Shippuden
- [ ] One Piece
- [ ] Steins;Gate
- [ ] Neon Genesis Evangelion
- [ ] Cowboy Bebop
- [ ] Berserk
- [ ] My Hero Academia
- [ ] One Punch Man
- [ ] Mob Psycho 100
- [ ] Gintama
- [ ] Your Lie in April

**Timeline**: ~30-45 min per profile, target 1,200-1,800 words each  
**Optimization**: Batch optimize after reaching 50+ profiles (40-50% reduction target)

**Detailed Roadmap**: See `aidm/libraries/narrative_profiles/EXPANSION_ROADMAP.md`
- Top 100 all-time anime list (organized by tier)
- Genre-specific top lists (Battle Shonen, Seinen, Isekai, etc.)
- 4-phase expansion strategy (25â†’40â†’70â†’100 profiles)
- Community request tracking
- Rising 2024-2025 hits included

---

## System Architecture

### Core Instruction Modules (15 files)
- `00_system_initialization.md` - Bootstrap & lazy-loading (TIER 1/2/3 strategy)
- `01_cognitive_engine.md` - Intent classification
- `02_learning_engine.md` - Memory creation/retrieval
- `03_state_manager.md` - State validation/persistence
- `04_npc_intelligence.md` - NPC behavior
- `05_narrative_systems.md` - Story hooks/pacing
- `06_session_zero.md` - Character creation
- `07_anime_integration.md` - Research & harmonization
- `08_combat_resolution.md` - Battle mechanics
- `09_progression_systems.md` - XP & leveling
- `10_error_recovery.md` - Error handling
- `11_dice_resolution.md` - RNG transparency
- `12_player_agency.md` - Sacred choice rule
- `13_narrative_calibration.md` - **Narrative DNA system** âœ… (optimized)
- `CORE_AIDM_INSTRUCTIONS.md` - Master control

### Narrative Profile Library (13 â†’ 100+ profiles)
**Current (13 profiles)**:
- DanDaDan, Hunter x Hunter, Jujutsu Kaisen, Demon Slayer, Attack on Titan
- Konosuba, Death Note, Re:Zero, Mushishi, Vinland Saga
- Code Geass, Haikyuu, (original profile)

**Master Index**: `PROFILE_INDEX.md` âœ… (optimized, 1,186 words)
- Genre organization (Battle Shonen, Dark Fantasy, Comedy, etc.)
- Cross-reference matrix (15 player request mappings)
- Blending guidelines (hybrid campaign strategies)
- 4 quick-start workflows

**Profile Structure** (standardized):
- 10 narrative scales (0-10 values)
- 15 trope switches (ON/OFF)
- Pacing rhythm, tonal signature, dialogue/combat styles
- 3 example scenes (combat, dialogue, exploration)
- Usage notes & calibration tips

**Lazy Loading** âœ…:
- Module 13: TIER 2 (loaded with Module 07)
- PROFILE_INDEX: TIER 3 (Session Zero only)
- Individual profiles: TIER 3 (only when selected)
- **Token cost**: 0 if unused, ~3,500-5,300 for typical usage (1-2 profiles)

### Reference Libraries (12 files)
**Power Systems** (5 files):
- `mana_magic_systems.md` - External energy (Fairy Tail, Black Clover, etc.)
- `ki_lifeforce_systems.md` - Internal energy (Dragon Ball, Naruto, HxH, etc.)
- `soul_spirit_systems.md` - Metaphysical (Jujutsu Kaisen, Bleach, etc.)
- `psionic_psychic_systems.md` - Mental powers (Mob Psycho, Saiki K, etc.)
- `power_tier_reference.md` - VS Battles tier mapping

**Genre Tropes** (4 files):
- `isekai_tropes.md` - 5 isekai variants, cheat skills, guild systems
- `shonen_tropes.md` - Training arcs, tournaments, transformations
- `seinen_tropes.md` - Psychological thriller, death games, anti-heroes
- `slice_of_life_tropes.md` - School life, romance, iyashikei

**Common Mechanics** (3 files):
- `stat_frameworks.md` - 6-stat D&D, anime-specific systems
- `leveling_curves.md` - XP systems, progression speeds
- `skill_taxonomies.md` - Active/passive/ultimate skills

### Schemas (8 JSON files)
- `character_schema.json`, `world_state_schema.json`, `session_export_schema.json`
- `npc_schema.json`, `memory_thread_schema.json`, `power_system_schema.json`
- `anime_world_schema.json`, `narrative_profile_schema.json`

---

## Token Budget Analysis

**Current System** (~20,567 tokens, 10.3% of 200K):
- Core instructions: ~13,669 tokens (15 modules optimized)
- Narrative system: ~2,326 tokens (Module 13 + INDEX optimized)
- Libraries: ~4,500 tokens (power systems, genres, mechanics)
- Schemas: ~72 tokens (compact JSON)

**Narrative Profile Impact** (lazy-loaded):
- **Scenario 1** (no calibration): 0 tokens
- **Scenario 2** (typical, 1-2 profiles): ~3,500-5,300 tokens
- **Scenario 3** (hybrid, 3 profiles): ~5,900-7,100 tokens
- **Worst case** (all 13 profiles): ~18,741 tokens (not recommended)

**Total Budget** (typical usage): ~24,000-26,000 tokens (12-13% of 200K) âœ…

---

## Next Actions

**Immediate**:
1. **Continue Phase 1 expansion**: Create next profile (FMA:B, Naruto, or One Piece)
2. **Batch creation option**: Create 3-5 profiles in one session
3. **Track progress**: Update EXPANSION_ROADMAP.md after each profile

**Short-term** (after Phase 1 complete):
- Fill genre gaps (Phase 2: 15 more profiles â†’ 40 total)
- Optimize all profiles at once (40-50% reduction, ~8,000 tokens saved)

**Long-term**:
- Deep genre coverage (Phase 3: 70 profiles)
- Long tail + niche (Phase 4: 100+ profiles)
- Community request tracking

**Detailed roadmap**: See `aidm/libraries/narrative_profiles/EXPANSION_ROADMAP.md`

---

## ðŸ“‹ Quick Commands for Development

### Word Counting (Token Estimation)
```powershell
# Single file word count
Get-Content "aidm/instructions/13_narrative_calibration.md" | Measure-Object -Word | Select-Object -ExpandProperty Words

# Multiple files total
$files = @("hunter_x_hunter_profile.md", "attack_on_titan_profile.md"); 
$total = 0; 
foreach($f in $files) { 
    $wc = (Get-Content "aidm/libraries/narrative_profiles\$f" | Measure-Object -Word).Words; 
    $total += $wc 
}; 
Write-Output "Total: $total words (~$([math]::Round($total * 0.75)) tokens)"
```

### Git Workflow
```powershell
# Check status
git status

# Add and commit
git add aidm/libraries/narrative_profiles/*.md
git commit -m "PROFILES: Add [anime names] profiles"

# Push to GitHub
git push origin main

# View recent commits
git log --oneline -5
```

### Validation Tests
```powershell
# Check if all critical data preserved (example)
Get-Content "aidm/instructions/13_narrative_calibration.md" | Select-String -Pattern "Introspection vs Action|Comedy vs Drama" | Measure-Object | Select-Object -ExpandProperty Count

# Verify profile IDs exist in index
Get-Content "aidm/libraries/narrative_profiles/PROFILE_INDEX.md" | Select-String -Pattern "narrative_hxh|narrative_aot" | Measure-Object | Select-Object -ExpandProperty Count
```

---

## Key Design Principles

1. **Player Agency is Sacred** - Choices must matter, railroading forbidden
2. **Emergent > Predetermined** - React to players, don't force plots
3. **Consistency is Critical** - State must remain logically coherent
4. **Fail Safely** - Errors handled gracefully, never crash
5. **Research First** - Never fake anime knowledge (AUTOMATIC, BLOCKING)
6. **Yes, And...** - Default to enabling creativity, not blocking it
7. **Zero Tolerance for Data Loss** - 100% information parity during optimization
8. **Machine-Interpreter Oriented** - Optimize for LLM parsing, not human decoration

---

## Quick Reference

- **Expansion Roadmap**: `aidm/libraries/narrative_profiles/EXPANSION_ROADMAP.md` - Top 100 anime list, 4-phase strategy
- **Profile Index**: `aidm/libraries/narrative_profiles/PROFILE_INDEX.md` - Master catalog, genre organization
- **Optimization Methodology**: `docs/TOKEN_OPTIMIZATION_METHODOLOGY.md` - Multi-pass techniques, validation protocols
- **Architecture**: `docs/ARCHITECTURE.md` - Complete system design
- **State**: `docs/STATE.md` - Current status, comprehensive changelog
- **Core Control**: `aidm/CORE_AIDM_INSTRUCTIONS.md` - Master control file

---

## Where to Continue Development

**Primary Focus**: Narrative Profile Library Expansion
1. **Review** `EXPANSION_ROADMAP.md` - Phase 1 target (next 12 profiles)
2. **Choose approach**: 
   - Single profile creation (30-45 min each)
   - Batch creation (3-5 profiles in one session)
   - Genre-focused (complete all top isekai, then shonen, etc.)
3. **Update** `PROFILE_INDEX.md` after each profile addition
4. **Commit** every 5 profiles with summary message

**Secondary Focus**: System testing and validation
- Execute acceptance tests as needed
- Validate narrative calibration in live gameplay
- Track profile usage for optimization prioritization

**GitHub Repository**: https://github.com/deusversus/animerpg

---

**CURRENT CONTEXT: Narrative Profile Library expansion phase. 13 profiles complete, targeting 100+ total. Phase 1 goal: Next 12 profiles to complete Top 25 all-time anime. See EXPANSION_ROADMAP.md for detailed plan.** ðŸŽ¯

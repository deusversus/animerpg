{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://aidm.dev/schemas/narrative_profile_schema.json",
  "title": "AIDM Narrative Profile Schema",
  "description": "Anime storytelling DNA: narrative approach extracted from source material",
  "type": "object",
  "required": ["schema_version", "profile_id", "source_anime", "narrative_scales", "storytelling_tropes", "pacing_rhythm", "tonal_signature"],
  "properties": {
    "schema_version": { "type": "string", "description": "Schema version", "pattern": "^\\d+\\.\\d+\\.\\d+$", "default": "2.2.0" },
    "profile_id": { "type": "string", "pattern": "^narrative_[a-z0-9_]+$" },
    "source_anime": { "type": "string", "description": "Source anime or 'custom' if player-defined" },
    "narrative_scales": {
      "type": "object",
      "description": "Storytelling scales (0-10)",
      "properties": {
        "introspection_vs_action": { "type": "integer", "minimum": 0, "maximum": 10, "description": "0=pure action (DBZ) | 5=balanced | 10=introspection (Evangelion)" },
        "comedy_vs_drama": { "type": "integer", "minimum": 0, "maximum": 10, "description": "0=gag comedy (Konosuba) | 5=tonal shifts | 10=pure drama (AoT)" },
        "simple_vs_complex": { "type": "integer", "minimum": 0, "maximum": 10, "description": "0=straightforward | 5=layered | 10=puzzle (Steins;Gate)" },
        "power_fantasy_vs_struggle": { "type": "integer", "minimum": 0, "maximum": 10, "description": "0=OP protagonist (Overlord) | 5=earned | 10=brutal underdog (Berserk)" },
        "explained_vs_mysterious": { "type": "integer", "minimum": 0, "maximum": 10, "description": "0=explained (HxH) | 5=selective | 10=ambiguous (Lain)" },
        "fast_paced_vs_slow_burn": { "type": "integer", "minimum": 0, "maximum": 10, "description": "0=rapid (Kill la Kill) | 5=moderate | 10=contemplative (Mushishi)" },
        "episodic_vs_serialized": { "type": "integer", "minimum": 0, "maximum": 10, "description": "0=standalone (Bebop) | 5=arcs | 10=continuous (AoT)" },
        "grounded_vs_absurd": { "type": "integer", "minimum": 0, "maximum": 10, "description": "0=realistic (Vinland Saga) | 5=anime logic | 10=surreal (FLCL)" },
        "tactical_vs_instinctive": { "type": "integer", "minimum": 0, "maximum": 10, "description": "0=pure instinct (Goku) | 5=adaptive | 10=chess (Death Note)" },
        "hopeful_vs_cynical": { "type": "integer", "minimum": 0, "maximum": 10, "description": "0=optimistic (Naruto) | 5=bittersweet | 10=dark (Texhnolyze)" }
      }
    },
    "storytelling_tropes": {
      "type": "object",
      "description": "Narrative patterns ON/OFF",
      "properties": {
        "fourth_wall_breaks": { "type": "boolean", "description": "Acknowledge audience (Gintama, Kaguya-sama)" },
        "inner_monologue_heavy": { "type": "boolean", "description": "Extensive thoughts (Death Note, Kaiji)" },
        "visual_metaphor_emphasis": { "type": "boolean", "description": "Symbolic imagery (Monogatari, Evangelion)" },
        "rapid_tonal_shifts": { "type": "boolean", "description": "Comedy→horror quickly (Gintama, DanDaDan)" },
        "tournament_arc_structure": { "type": "boolean", "description": "Competition formats (MHA, HxH)" },
        "power_of_friendship": { "type": "boolean", "description": "Bonds enable victory (Fairy Tail, Naruto)" },
        "tragic_backstory_reveals": { "type": "boolean", "description": "Flashbacks explain (One Piece, Demon Slayer)" },
        "escalating_threat_levels": { "type": "boolean", "description": "Each arc stronger (DBZ, Bleach)" },
        "slice_of_life_interludes": { "type": "boolean", "description": "Breather episodes (FMA, MHA)" },
        "mystery_box_reveals": { "type": "boolean", "description": "Long-term questions (One Piece, AoT)" },
        "unreliable_narrator": { "type": "boolean", "description": "Narration misleads (Monogatari, Higurashi)" },
        "existential_philosophy": { "type": "boolean", "description": "Debate meaning (Evangelion, Psycho-Pass)" },
        "rule_of_cool": { "type": "boolean", "description": "Style over logic (Gurren Lagann, JoJo)" },
        "mundane_made_epic": { "type": "boolean", "description": "Normal→dramatic (Food Wars, Chihayafuru)" },
        "tragic_hero_cycle": { "type": "boolean", "description": "Victory with loss (Berserk, Madoka)" }
      }
    },
    "pacing_rhythm": {
      "type": "object",
      "description": "Scene/arc structure",
      "properties": {
        "scene_length_preference": { "type": "string", "enum": ["rapid_cuts", "moderate", "lingering"], "description": "rapid=Trigger | lingering=Mushishi" },
        "arc_length_average": { "type": "string", "enum": ["mini_arcs_2_5_eps", "medium_arcs_6_12_eps", "long_arcs_13_25_eps", "saga_length_26_plus"], "description": "Translate to session count" },
        "filler_tolerance": { "type": "string", "enum": ["none", "rare_breathers", "frequent_interludes", "half_filler"] },
        "climax_frequency": { "type": "string", "enum": ["every_episode", "every_arc", "rare_peaks"] },
        "downtime_ratio": { "type": "number", "minimum": 0, "maximum": 1, "description": "% low-stakes sessions (0.1=10%)" }
      }
    },
    "tonal_signature": {
      "type": "object",
      "description": "Emotional atmosphere",
      "properties": {
        "primary_emotions": { "type": "array", "items": { "type": "string", "enum": ["hype", "dread", "wonder", "melancholy", "joy", "tension", "absurdity", "hope", "despair", "excitement", "contemplation", "romance", "comedy", "horror", "mystery", "catharsis"] }, "minItems": 1, "maxItems": 5, "description": "Top 1-5 emotions" },
        "violence_level": { "type": "string", "enum": ["none", "cartoon", "stylized", "graphic", "brutal"] },
        "fanservice_level": { "type": "string", "enum": ["none", "minimal", "moderate", "frequent", "plot_critical"] },
        "horror_elements": { "type": "string", "enum": ["none", "unsettling", "psychological", "body_horror", "cosmic_horror"] },
        "optimism_baseline": { "type": "string", "enum": ["nihilistic", "dark", "bittersweet", "hopeful", "idealistic"] }
      }
    },
    "dialogue_style": {
      "type": "object",
      "properties": {
        "formality_default": { "type": "string", "enum": ["very_casual", "casual", "mixed", "formal", "very_formal"] },
        "exposition_method": { "type": "string", "enum": ["show_not_tell", "balanced", "lecture_heavy", "cryptic_hints"] },
        "banter_frequency": { "type": "string", "enum": ["rare", "occasional", "frequent", "constant"] },
        "dramatic_declarations": { "type": "boolean", "description": "Announce attacks/intentions (shonen)" },
        "philosophical_debates": { "type": "boolean", "description": "Discuss ideals mid-combat (Fate, Code Geass)" },
        "awkward_comedy": { "type": "boolean", "description": "Misunderstandings drive humor (romcoms)" }
      }
    },
    "combat_narrative_style": {
      "type": "object",
      "description": "Fight narration (if action)",
      "properties": {
        "strategy_vs_spectacle": { "type": "integer", "minimum": 0, "maximum": 10, "description": "0=spectacle (DBZ) | 5=mixed | 10=chess (HxH)" },
        "power_explanations": { "type": "string", "enum": ["never", "minimal", "moderate", "exhaustive"], "description": "HxH=exhaustive, DBZ=minimal" },
        "sakuga_moments": { "type": "boolean", "description": "Describe animation quality/fluidity (Ufotable, Trigger)" },
        "named_attacks": { "type": "boolean", "description": "Shout technique names" },
        "environmental_destruction": { "type": "string", "enum": ["minimal", "moderate", "city_leveling", "planetary"] }
      }
    },
    "op_protagonist_mode": {
      "type": "object",
      "description": "Overpowered protagonist narrative handling",
      "properties": {
        "enabled": { "type": "boolean", "default": false, "description": "True if character is OP protagonist archetype" },
        "archetype": { 
          "type": "string", 
          "enum": [
            "saitama_invincible",
            "mob_restraint", 
            "overlord_roleplaying",
            "saiki_oblivious",
            "mashle_absurd",
            "wang_ling_secret",
            "vampire_d_legend",
            "slime_builder",
            "deus_disguised_god",
            "custom"
          ],
          "description": "Which OP archetype: saitama (bored god), mob (restraint/emotion), overlord (roleplay evil/role), saiki (wants normalcy), mashle (absurd gap), wang_ling (sealed at school), vampire_d (wandering legend), slime (nation builder), deus (god incognito), custom"
        },
        "techniques": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "ensemble_safety_net",
              "reverse_ensemble_threat",
              "op_as_deus_ex",
              "power_as_burden",
              "comedic_obliviousness",
              "emotional_core",
              "self_limitation",
              "simple_goals",
              "secret_identity",
              "contrast_device",
              "mythology_journey",
              "faction_building",
              "internal_conflict",
              "existential_stakes",
              "tonal_contrast"
            ]
          },
          "description": "Narrative techniques to apply"
        },
        "scale_preference": {
          "type": "string",
          "enum": [
            "tactical_survival",
            "strategic_combat",
            "ensemble_focus",
            "reverse_ensemble",
            "mythology_journey",
            "faction_building",
            "mythic_spectacle",
            "conceptual_philosophy",
            "metafictional"
          ],
          "description": "Preferred narrative scale for this OP archetype"
        },
        "power_imbalance_threshold": {
          "type": "number",
          "default": 10.0,
          "description": "Ratio at which to shift narrative scale (default 10, OP mode lowers to ~5)"
        }
      }
    },
    "tension_preferences": {
      "type": "object",
      "description": "Player preferences for non-combat tension (Module 12)",
      "properties": {
        "social_tension": {
          "type": "boolean",
          "default": true,
          "description": "Enable social conflicts (secret identity, power reveal, faction politics)"
        },
        "existential_tension": {
          "type": "boolean",
          "default": true,
          "description": "Enable existential stakes (boredom, purpose, loneliness)"
        },
        "structural_tension": {
          "type": "boolean",
          "default": true,
          "description": "Enable structural challenges (time limits, puzzles, restrictions)"
        },
        "preferred_categories": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["social", "existential", "structural"]
          },
          "description": "Prioritize these tension types"
        }
      }
    },
    "mechanical_modules": {
      "type": "object",
      "description": "Selected mechanical subsystems for this narrative profile",
      "properties": {
        "economy": {
          "type": "object",
          "properties": {
            "type": { "type": "string", "enum": ["fiat_currency", "barter", "abstract_wealth", "reputation_based", "none"] },
            "config": { "type": "object" }
          },
          "required": ["type"]
        },
        "crafting": {
          "type": "object",
          "properties": {
            "type": { "type": "string", "enum": ["recipe_based", "skill_based", "experimental", "equivalent_exchange", "none"] },
            "config": { "type": "object" }
          },
          "required": ["type"]
        },
        "progression": {
          "type": "object",
          "properties": {
            "type": { "type": "string", "enum": ["mastery_tiers", "class_based", "quirk_awakening", "milestone_based", "static_op"] },
            "config": { "type": "object" }
          },
          "required": ["type"]
        },
        "downtime": {
          "type": "object",
          "properties": {
            "enabled_activities": { "type": "array", "items": { "type": "string" } },
            "config": { "type": "object" }
          },
          "required": ["enabled_activities"]
        }
      }
    },
    "meta_context": {
      "type": "object",
      "properties": {
        "extraction_method": { "type": "string", "enum": ["research_derived", "player_provided", "aidm_inferred", "hybrid"] },
        "confidence_level": { "type": "integer", "minimum": 0, "maximum": 100, "description": "AIDM confidence (0-100%)" },
        "last_calibration": { "type": "string", "format": "date-time" },
        "player_approved": { "type": "boolean" },
        "adjustments_log": { "type": "array", "items": { "type": "object", "properties": { "session": { "type": "integer" }, "adjustment": { "type": "string" }, "reason": { "type": "string" } } }, "description": "Track tweaks from feedback" }
      }
    },
    "example_scenes": {
      "type": "array",
      "description": "Reference narration samples",
      "items": {
        "type": "object",
        "properties": {
          "scene_type": { "type": "string", "enum": ["combat", "dialogue", "exploration", "emotional_peak", "comedy", "mystery"] },
          "example_narration": { "type": "string", "description": "2-3 paragraph sample" },
          "key_techniques": { "type": "array", "items": { "type": "string" }, "description": "What makes this feel like source" }
        }
      }
    }
  }
}

{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://aidm.dev/schemas/narrative_profile_schema.json",
  "title": "AIDM Narrative Profile Schema",
  "description": "Defines how an anime tells its story - narrative DNA extracted from source material to guide AIDM's storytelling approach",
  "type": "object",
  "required": [
    "profile_id",
    "source_anime",
    "narrative_scales",
    "storytelling_tropes",
    "pacing_rhythm",
    "tonal_signature"
  ],
  "properties": {
    "profile_id": {
      "type": "string",
      "pattern": "^narrative_[a-z0-9_]+$"
    },
    "source_anime": {
      "type": "string",
      "description": "Anime this profile is extracted from (or 'custom' if player-defined)"
    },
    "narrative_scales": {
      "type": "object",
      "description": "Sliding scales (0-10) defining storytelling approach",
      "properties": {
        "introspection_vs_action": {
          "type": "integer",
          "minimum": 0,
          "maximum": 10,
          "description": "0=pure action (Dragon Ball) | 5=balanced | 10=heavy introspection (Evangelion, Monogatari)"
        },
        "comedy_vs_drama": {
          "type": "integer",
          "minimum": 0,
          "maximum": 10,
          "description": "0=gag comedy (Konosuba, Gintama) | 5=tonal shifts | 10=pure drama (AoT, Vinland Saga)"
        },
        "simple_vs_complex": {
          "type": "integer",
          "minimum": 0,
          "maximum": 10,
          "description": "0=straightforward (One Piece early) | 5=layered | 10=puzzle box (Steins;Gate, Madoka)"
        },
        "power_fantasy_vs_struggle": {
          "type": "integer",
          "minimum": 0,
          "maximum": 10,
          "description": "0=OP protagonist (Overlord, Saitama) | 5=earned victories | 10=brutal underdog (Berserk, Re:Zero)"
        },
        "explained_vs_mysterious": {
          "type": "integer",
          "minimum": 0,
          "maximum": 10,
          "description": "0=everything explained (Dr. Stone, HxH) | 5=selective reveals | 10=ambiguous (Lain, Mushishi)"
        },
        "fast_paced_vs_slow_burn": {
          "type": "integer",
          "minimum": 0,
          "maximum": 10,
          "description": "0=rapid fire (Kill la Kill, Trigger style) | 5=moderate | 10=contemplative (Aria, Mushishi)"
        },
        "episodic_vs_serialized": {
          "type": "integer",
          "minimum": 0,
          "maximum": 10,
          "description": "0=standalone episodes (Cowboy Bebop, Kino's Journey) | 5=arcs | 10=continuous plot (AoT, Code Geass)"
        },
        "grounded_vs_absurd": {
          "type": "integer",
          "minimum": 0,
          "maximum": 10,
          "description": "0=realistic tone (Vinland Saga) | 5=anime logic | 10=surreal chaos (FLCL, Monogatari, DanDaDan)"
        },
        "tactical_vs_instinctive": {
          "type": "integer",
          "minimum": 0,
          "maximum": 10,
          "description": "0=pure instinct (Goku) | 5=adaptive | 10=chess match (Death Note, Code Geass, HxH)"
        },
        "hopeful_vs_cynical": {
          "type": "integer",
          "minimum": 0,
          "maximum": 10,
          "description": "0=optimistic (Naruto, MHA) | 5=bittersweet | 10=dark (Berserk, Texhnolyze)"
        }
      }
    },
    "storytelling_tropes": {
      "type": "object",
      "description": "ON/OFF switches for narrative patterns specific to this anime",
      "properties": {
        "fourth_wall_breaks": {
          "type": "boolean",
          "description": "Narrator/characters acknowledge audience (Gintama, Kaguya-sama)"
        },
        "inner_monologue_heavy": {
          "type": "boolean",
          "description": "Extensive character thoughts (Death Note, Kaiji, Monogatari)"
        },
        "visual_metaphor_emphasis": {
          "type": "boolean",
          "description": "Symbolic imagery in narration (Monogatari, Mob Psycho, Evangelion)"
        },
        "rapid_tonal_shifts": {
          "type": "boolean",
          "description": "Comedy→horror→drama quickly (Gintama, DanDaDan, Dorohedoro)"
        },
        "tournament_arc_structure": {
          "type": "boolean",
          "description": "Frequent competitive formats (MHA, YuYu Hakusho, HxH)"
        },
        "power_of_friendship": {
          "type": "boolean",
          "description": "Bonds enable victory (Fairy Tail, Naruto, One Piece)"
        },
        "tragic_backstory_reveals": {
          "type": "boolean",
          "description": "Flashbacks explain motivations (Naruto, Demon Slayer, One Piece)"
        },
        "escalating_threat_levels": {
          "type": "boolean",
          "description": "Each arc stronger enemy (DBZ, Bleach, typical shonen)"
        },
        "slice_of_life_interludes": {
          "type": "boolean",
          "description": "Breather episodes between action (FMA, MHA, Demon Slayer)"
        },
        "mystery_box_reveals": {
          "type": "boolean",
          "description": "Long-term questions (One Piece, AoT, Promised Neverland)"
        },
        "unreliable_narrator": {
          "type": "boolean",
          "description": "Narration misleads (Monogatari, Higurashi, some Trigger shows)"
        },
        "existential_philosophy": {
          "type": "boolean",
          "description": "Characters debate meaning (Evangelion, Lain, Psycho-Pass)"
        },
        "rule_of_cool": {
          "type": "boolean",
          "description": "Style over logic (Gurren Lagann, Kill la Kill, JoJo)"
        },
        "mundane_made_epic": {
          "type": "boolean",
          "description": "Normal things dramatic (Food Wars, Chihayafuru, Hikaru no Go)"
        },
        "tragic_hero_cycle": {
          "type": "boolean",
          "description": "Victory comes with loss (Berserk, Re:Zero, Madoka)"
        }
      }
    },
    "pacing_rhythm": {
      "type": "object",
      "description": "How scenes and arcs are structured",
      "properties": {
        "scene_length_preference": {
          "type": "string",
          "enum": ["rapid_cuts", "moderate", "lingering"],
          "description": "rapid=Trigger style | moderate=typical | lingering=Mushishi, Aria"
        },
        "arc_length_average": {
          "type": "string",
          "enum": ["mini_arcs_2_5_eps", "medium_arcs_6_12_eps", "long_arcs_13_25_eps", "saga_length_26_plus"],
          "description": "Typical story arc duration (translate to session count)"
        },
        "filler_tolerance": {
          "type": "string",
          "enum": ["none", "rare_breathers", "frequent_interludes", "half_filler"],
          "description": "How often non-plot episodes occur"
        },
        "climax_frequency": {
          "type": "string",
          "enum": ["every_episode", "every_arc", "rare_peaks"],
          "description": "How often major dramatic peaks happen"
        },
        "downtime_ratio": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "% of sessions that are low-stakes (0.1=10% breathers, 0.5=half)"
        }
      }
    },
    "tonal_signature": {
      "type": "object",
      "description": "Emotional atmosphere and mood",
      "properties": {
        "primary_emotions": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "hype", "dread", "wonder", "melancholy", "joy", "tension",
              "absurdity", "hope", "despair", "excitement", "contemplation",
              "romance", "comedy", "horror", "mystery", "catharsis"
            ]
          },
          "minItems": 1,
          "maxItems": 5,
          "description": "Top 1-5 emotions this anime evokes"
        },
        "violence_level": {
          "type": "string",
          "enum": ["none", "cartoon", "stylized", "graphic", "brutal"],
          "description": "How violence is portrayed"
        },
        "fanservice_level": {
          "type": "string",
          "enum": ["none", "minimal", "moderate", "frequent", "plot_critical"],
          "description": "Ecchi/fanservice presence"
        },
        "horror_elements": {
          "type": "string",
          "enum": ["none", "unsettling", "psychological", "body_horror", "cosmic_horror"],
          "description": "Type of scary content if present"
        },
        "optimism_baseline": {
          "type": "string",
          "enum": ["nihilistic", "dark", "bittersweet", "hopeful", "idealistic"],
          "description": "Default worldview tone"
        }
      }
    },
    "dialogue_style": {
      "type": "object",
      "description": "How characters speak and interact",
      "properties": {
        "formality_default": {
          "type": "string",
          "enum": ["very_casual", "casual", "mixed", "formal", "very_formal"],
          "description": "Typical speech patterns"
        },
        "exposition_method": {
          "type": "string",
          "enum": ["show_not_tell", "balanced", "lecture_heavy", "cryptic_hints"],
          "description": "How information is conveyed"
        },
        "banter_frequency": {
          "type": "string",
          "enum": ["rare", "occasional", "frequent", "constant"],
          "description": "How much playful dialogue happens"
        },
        "dramatic_declarations": {
          "type": "boolean",
          "description": "Characters announce attacks/intentions (shonen staple)"
        },
        "philosophical_debates": {
          "type": "boolean",
          "description": "Characters discuss ideals mid-combat (Fate, Code Geass)"
        },
        "awkward_comedy": {
          "type": "boolean",
          "description": "Misunderstandings drive humor (romcoms, Kaguya-sama)"
        }
      }
    },
    "combat_narrative_style": {
      "type": "object",
      "description": "How fights are narrated (if action anime)",
      "properties": {
        "strategy_vs_spectacle": {
          "type": "integer",
          "minimum": 0,
          "maximum": 10,
          "description": "0=pure spectacle (DBZ) | 5=mixed | 10=chess match (HxH, JoJo)"
        },
        "power_explanations": {
          "type": "string",
          "enum": ["never", "minimal", "moderate", "exhaustive"],
          "description": "How much abilities are explained (HxH=exhaustive, DBZ=minimal)"
        },
        "sakuga_moments": {
          "type": "boolean",
          "description": "Describe animation quality/fluidity in narration (Ufotable, Trigger style)"
        },
        "named_attacks": {
          "type": "boolean",
          "description": "Characters shout technique names"
        },
        "environmental_destruction": {
          "type": "string",
          "enum": ["minimal", "moderate", "city_leveling", "planetary"],
          "description": "Scale of collateral damage"
        }
      }
    },
    "meta_context": {
      "type": "object",
      "description": "How this profile is used",
      "properties": {
        "extraction_method": {
          "type": "string",
          "enum": ["research_derived", "player_provided", "aidm_inferred", "hybrid"],
          "description": "How profile was created"
        },
        "confidence_level": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "AIDM confidence in accuracy (0-100%)"
        },
        "last_calibration": {
          "type": "string",
          "format": "date-time",
          "description": "When profile was last updated"
        },
        "player_approved": {
          "type": "boolean",
          "description": "Player confirmed this feels right"
        },
        "adjustments_log": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "session": {"type": "integer"},
              "adjustment": {"type": "string"},
              "reason": {"type": "string"}
            }
          },
          "description": "Track tweaks based on player feedback"
        }
      }
    },
    "example_scenes": {
      "type": "array",
      "description": "Reference narration samples showing this profile in action",
      "items": {
        "type": "object",
        "properties": {
          "scene_type": {
            "type": "string",
            "enum": ["combat", "dialogue", "exploration", "emotional_peak", "comedy", "mystery"]
          },
          "example_narration": {
            "type": "string",
            "description": "2-3 paragraph sample showing narrative voice"
          },
          "key_techniques": {
            "type": "array",
            "items": {"type": "string"},
            "description": "What makes this feel like the source anime"
          }
        }
      }
    }
  }
}

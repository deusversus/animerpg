{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "economy_meta_schema.json",
  "title": "Economy Meta-Schema",
  "description": "Parameterized meta-schema for economy systems. Defines configuration options that get instantiated at Session Zero based on narrative profile settings.",
  "version": "1.0.0",
  "type": "object",
  "required": ["type"],
  "properties": {
    "type": {
      "type": "string",
      "description": "The economic system type that determines available parameters and mechanics",
      "enum": ["fiat_currency", "barter", "abstract_wealth", "reputation_based", "none"]
    }
  },
  "allOf": [
    {
      "if": {
        "properties": { "type": { "const": "fiat_currency" } }
      },
      "then": {
        "properties": {
          "type": { "const": "fiat_currency" },
          "parameters": {
            "type": "object",
            "required": ["currency_name"],
            "properties": {
              "currency_name": {
                "type": "string",
                "description": "Name of the currency (e.g., 'Jenny', 'Berries', 'Gold')"
              },
              "starting_amount": {
                "type": "number",
                "description": "Starting currency for new characters",
                "default": 200,
                "minimum": 0
              },
              "scarcity": {
                "type": "string",
                "description": "How abundant resources are",
                "enum": ["abundant", "normal", "scarce"],
                "default": "normal"
              },
              "inflation_rate": {
                "type": "string",
                "description": "Currency inflation over time",
                "enum": ["none", "low", "moderate", "high"],
                "default": "none"
              },
              "special_mechanics": {
                "type": "array",
                "description": "Economy-specific features (e.g., 'bounty_system', 'taxes')",
                "items": { "type": "string" },
                "default": []
              }
            }
          },
          "mechanics": {
            "type": "object",
            "description": "How this economy type functions in gameplay",
            "properties": {
              "transactions": { "type": "string", "const": "standard_merchant_system" },
              "loot_generation": { "type": "string", "const": "currency_drops" },
              "quest_rewards": { "type": "string", "const": "currency_based" }
            }
          }
        },
        "required": ["parameters", "mechanics"]
      }
    },
    {
      "if": {
        "properties": { "type": { "const": "barter" } }
      },
      "then": {
        "properties": {
          "type": { "const": "barter" },
          "parameters": {
            "type": "object",
            "required": ["trade_goods"],
            "properties": {
              "trade_goods": {
                "type": "array",
                "description": "List of tradeable goods (e.g., ['food', 'water', 'ammo'])",
                "items": { "type": "string" },
                "minItems": 1
              },
              "value_ratios": {
                "type": "object",
                "description": "Exchange rates between goods (e.g., {'food': 1, 'water': 2})",
                "additionalProperties": { "type": "number" }
              }
            }
          },
          "mechanics": {
            "type": "object",
            "properties": {
              "transactions": { "type": "string", "const": "negotiation_system" },
              "loot_generation": { "type": "string", "const": "item_drops_only" },
              "quest_rewards": { "type": "string", "const": "item_based" }
            }
          }
        },
        "required": ["parameters", "mechanics"]
      }
    },
    {
      "if": {
        "properties": { "type": { "const": "abstract_wealth" } }
      },
      "then": {
        "properties": {
          "type": { "const": "abstract_wealth" },
          "parameters": {
            "type": "object",
            "properties": {
              "wealth_levels": {
                "type": "array",
                "description": "Wealth tiers instead of exact currency",
                "items": { "type": "string" },
                "default": ["Poor", "Modest", "Comfortable", "Wealthy", "Rich"]
              },
              "lifestyle_costs": {
                "type": "object",
                "description": "What each wealth level can afford",
                "additionalProperties": { "type": "string" }
              }
            }
          },
          "mechanics": {
            "type": "object",
            "properties": {
              "transactions": { "type": "string", "const": "wealth_check_system" },
              "loot_generation": { "type": "string", "const": "wealth_tier_increases" },
              "quest_rewards": { "type": "string", "const": "lifestyle_upgrades" }
            }
          }
        },
        "required": ["parameters", "mechanics"]
      }
    },
    {
      "if": {
        "properties": { "type": { "const": "reputation_based" } }
      },
      "then": {
        "properties": {
          "type": { "const": "reputation_based" },
          "parameters": {
            "type": "object",
            "required": ["reputation_name", "gain_methods", "loss_methods"],
            "properties": {
              "reputation_name": {
                "type": "string",
                "description": "Name of the reputation currency (e.g., 'Social Credit', 'Honor')"
              },
              "gain_methods": {
                "type": "array",
                "description": "Ways to gain reputation",
                "items": { "type": "string" },
                "minItems": 1
              },
              "loss_methods": {
                "type": "array",
                "description": "Ways to lose reputation",
                "items": { "type": "string" },
                "minItems": 1
              }
            }
          },
          "mechanics": {
            "type": "object",
            "properties": {
              "transactions": { "type": "string", "const": "reputation_check_system" },
              "loot_generation": { "type": "string", "const": "reputation_gains" },
              "quest_rewards": { "type": "string", "const": "reputation_based" }
            }
          }
        },
        "required": ["parameters", "mechanics"]
      }
    },
    {
      "if": {
        "properties": { "type": { "const": "none" } }
      },
      "then": {
        "properties": {
          "type": { "const": "none" },
          "parameters": {
            "type": "object",
            "properties": {},
            "additionalProperties": false
          },
          "mechanics": {
            "type": "object",
            "properties": {
              "transactions": { "type": "string", "const": "disabled" },
              "loot_generation": { "type": "string", "const": "narrative_only" },
              "quest_rewards": { "type": "string", "const": "non_monetary" }
            }
          }
        },
        "required": ["mechanics"]
      }
    }
  ]
}
